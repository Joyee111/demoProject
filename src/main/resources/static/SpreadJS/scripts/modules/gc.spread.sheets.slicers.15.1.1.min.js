/*!
 * 
 * SpreadJS Library 15.1.1
 * 
 * Copyright(c) GrapeCity, Inc.  All rights reserved.
 * 
 * Licensed under the SpreadJS Commercial License.
 * us.sales@grapecity.com
 * http://www.grapecity.com/en/licensing/grapecity/
 * 
 * 
 */
var GC="object"==typeof GC?GC:{};GC.Spread=GC.Spread||{},GC.Spread.Sheets=GC.Spread.Sheets||{},GC.Spread.Sheets.Slicers=function(a){var b={};function c(d){if(b[d])return b[d].exports;var e=b[d]={i:d,l:!1,exports:{}};return a[d].call(e.exports,e,e.exports,c),e.l=!0,e.exports}return c.m=a,c.c=b,c.d=function(a,b,d){c.o(a,b)||Object.defineProperty(a,b,{enumerable:!0,get:d})},c.r=function(a){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(a,"__esModule",{value:!0})},c.t=function(a,b){var d,e;if(1&b&&(a=c(a)),8&b)return a;if(4&b&&"object"==typeof a&&a&&a.__esModule)return a;if(d=Object.create(null),c.r(d),Object.defineProperty(d,"default",{enumerable:!0,value:a}),2&b&&"string"!=typeof a)for(e in a)c.d(d,e,function(b){return a[b]}.bind(null,e));return d},c.n=function(a){var b=a&&a.__esModule?function b(){return a.default}:function b(){return a};return c.d(b,"a",b),b},c.o=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)},c.p="/assets/",c(c.s="./dist/plugins/slicer/slicer.entry.js")}({"./dist/plugins/slicer/slicer-actions.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e=d.Commands.ActionBase;function k(a){if(a.canUndo()){var b=a.kj,c=d.Commands.bWa(b.name()),e=a.VQ[c];return a.Lz(b,!0),b.ITa.undo(e),a.Mz(b,!0),!0}return!1}function l(a,b,c){var d,e,f=a.parent,g=a.slicers.get(c);f&&b.xC&&g&&(d=g.startRow(),e=g.startColumn(),f.changeSelectionInCommandExecuting(b,d,e,[],[g]))}function m(a,b){for(var c=0;c<a.length;c++)if(a[c].columnName===b)return a[c]._ps&&a[c]._ps.name}f=function(a){j(b,a);function b(b,c){return a.call(this,b,c)||this}return b.prototype.canExecute=function(){return!!this.VQ.slicerData},b.prototype.execute=function(){var a,b,c,e=this,f=e.VQ;return!!e.canExecute()&&(a=e.kj,b=m(f.slicerData.Ze,f.columnName),l(a,f,b),a.ITa.startTransaction(),e.Lz(a,!0),f.slicerData.doFilter(f.columnName,{exclusiveRowIndexes:f.newValue}),e.Mz(a,!0),c=d.Commands.bWa(a.name()),e.VQ[c]=a.ITa.endTransaction(),!0)},b.prototype.canUndo=function(){return!!this.VQ.slicerData},b.prototype.undo=function(){return k(this)},b}(e),g=function(a){j(b,a);function b(b,c){return a.call(this,b,c)||this}return b.prototype.canExecute=function(){return!!this.VQ.slicerData},b.prototype.execute=function(){var a,b,c,e=this,f=e.VQ;return!!e.canExecute()&&(a=e.kj,b=m(f.slicerData.Ze,f.columnName),l(a,f,b),a.ITa.startTransaction(),e.Lz(a,!0),f.slicerData.doUnfilter(f.columnName),e.Mz(a,!0),c=d.Commands.bWa(a.name()),e.VQ[c]=a.ITa.endTransaction(),!0)},b.prototype.canUndo=function(){return!!this.VQ.slicerData},b.prototype.undo=function(){return k(this)},b}(e),h=function(a){j(b,a);function b(b,c){return a.call(this,b,c)||this}return b.prototype.canExecute=function(){return!!this.VQ.slicer},b.prototype.execute=function(){var a,b,c=this,d=c.VQ;return!!c.canExecute()&&(a=c.kj,b=m(d.slicerData.Ze,d.columnName),l(a,d,b),c.Lz(a,!0),d.slicer[d.propertyName](d.newValue),c.Mz(a,!0),!0)},b.prototype.canUndo=function(){return!!this.VQ.slicer},b.prototype.undo=function(){var a,b=this,c=b.VQ;return!!b.canUndo()&&(a=b.kj,b.Lz(a,!0),c.slicer[c.propertyName](c.oldValue),b.Mz(a,!0),!0)},b}(e),i=d.Commands.h4,d.Commands.filterSlicer={canUndo:!0,execute:function(a,b,c){return i(a,f,b,c)}},d.Commands.unfilterSlicer={canUndo:!0,execute:function(a,b,c){return i(a,g,b,c)}},d.Commands.changeSlicerProperty={canUndo:!0,execute:function(a,b,c){return i(a,h,b,c)}},d.Commands.unfilterSlicerByKey={canUndo:!1,execute:function(a,b){var c,e,f,g=d.Commands.bT(a,b),h=g.slicers.UX();if(1===h.length&&(c=h[0],e=c.YX()))return f=e.getFilteredIndexes(c.columnName()),g.wu().execute({cmd:"unfilterSlicer",sheetName:g.name(),slicerData:e,columnName:c.columnName(),value:f})}}},"./dist/plugins/slicer/slicer-style.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la,ma,na,oa,pa,qa,ra,sa,ta,ua,va,wa,xa,ya;for(Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e=c("Common"),f=d.Ul.Pl,g=d.Ul.Ol,h=e.Common.k.ac,i=null,j=void 0,k="normal 11pt calibri",l={N8c:"Style",O8c:"Color",P8c:"Width",JLb:"border",OLb:"top",RLb:"header",TLb:"body",Q8c:"periodLabel",R8c:"selectedTimeBlock",KLb:"WithDataStyle",LLb:"WithNoDataStyle",MLb:"electedItem",NLb:"hovered",PLb:"gc-slicer-",QLb:"container",SLb:"clearfilter",ULb:"itemscontainer",VLb:"item"},m="name",n="light",o="dark",p="white",q="black",r="thin",s="font",t="setBorders",u="back"+l.O8c,v="fore"+l.O8c,w=l.JLb+"Width",x=l.JLb+l.N8c,y=l.JLb+l.O8c,z=l.JLb+"Left",A=l.JLb+"Top",B=l.JLb+"Right",C=l.JLb+"Bottom",D="textDecoration",E="wholeSlicer"+l.N8c,F="header"+l.N8c,G="s"+l.MLb+l.KLb,H="s"+l.MLb+l.LLb,I="unS"+l.MLb+l.KLb,J="unS"+l.MLb+l.LLb,K=l.NLb+"S"+l.MLb+l.KLb,L=l.NLb+"S"+l.MLb+l.LLb,M=l.NLb+"UnS"+l.MLb+l.KLb,N=l.NLb+"UnS"+l.MLb+l.LLb,O="selectionLabel"+l.N8c,P="timeLevel"+l.N8c,Q=l.Q8c+"1"+l.N8c,R=l.Q8c+"2"+l.N8c,S=l.R8c+l.N8c,T="un"+l.R8c+l.N8c,U=l.R8c+"Space"+l.N8c,V="Accent ",W="Slicer"+l.N8c,X="Time"+W,Y="#999999",Z="#828282",$="#CCCCCC",_=" 40",aa=" 60",ba=" 80",ca=" -25",da=" -50",ea="bold 11pt calibri",fa="normal 10pt calibri",ga="normal 9pt calibri",ha="Text 1 50",ia="Background 1 -15",ja=["empty","thin","medium","dashed","dotted","thick","double","hair","mediumDashed","dashDot","mediumDashDot","dashDotDot","mediumDashDotDot","slantedDashDot"],ka=function(){function a(){var a=this;a[m]("",!1),a[E](Ca(),!1)}return a.prototype.fromJSON=function(b){var c,e,f,h;if(b&&!d.GC$.isEmptyObject(b))return c=this,e=b.name,g(e)&&(c.name(e),Da(e))?(f=e.toLocaleLowerCase().replace("slicerstyle","").replace(" ",""),h=za(f),void a.properties.forEach(function(a){c[a](h[a](),!1)})):void a.properties.forEach(function(a){var d,e=b[a];a!==m&&(d=za(),g(e)&&d.fromJSON(e),c[a](d,!1))})},a.prototype.toJSON=function(){var a,b,c,e=this;a=Da(e.name())?{name:e.name()}:e.toJSONInternal(),b={};for(c in a)a[c]===i||a[c]===j||d.GC$.isEmptyObject(a[c])||(b[c]=a[c]);return b},a.prototype.toJSONInternal=function(){var b,c,d,e=this,f={},g="toJSON";for(f[m]=e.name(),b=1,c=h(a.properties);b<c;b++)d=a.properties[b],f[d]=e[d]()?e[d]()[g]():i;return f},a.properties=[m,E,F,G,H,I,J,K,L,M,N],a}(),b.SlicerStyle=ka,la=function(){function a(){var a=this;a[m]("",!1),a[E](Ca(),!1)}return a.prototype.fromJSON=function(b){var c,e,f,h;if(b&&!d.GC$.isEmptyObject(b))return c=this,e=b.name,g(e)&&(c.name(e),Ea(e))?(f=e.toLocaleLowerCase().replace("timeslicerstyle","").replace(" ",""),h=Aa(f),void a.properties.forEach(function(a){c[a](h[a](),!1)})):void a.properties.forEach(function(a){var d,e=b[a];a!==m&&(d=Aa(),g(e)&&d.fromJSON(e),c[a](d,!1))})},a.prototype.toJSON=function(){var a,b,c,e=this;a=Ea(e.name())?{name:e.name()}:e.toJSONInternal(),b={};for(c in a)a[c]===i||a[c]===j||d.GC$.isEmptyObject(a[c])||(b[c]=a[c]);return b},a.prototype.toJSONInternal=function(){var b,c,d,e=this,f={},g="toJSON";for(f[m]=e.name(),b=1,c=h(a.properties);b<c;b++)d=a.properties[b],f[d]=e[d]()?e[d]()[g]():i;return f},a.properties=[m,E,F,O,P,Q,R,S,T,U],a}(),b.TimelineStyle=la,ma=function(){function a(b,c,d,e,f,g,i,j){for(var k=0,l=h(a.properties);k<l;k++)this[a.properties[k]](arguments[k])}return a.prototype.setBorders=function(a){var b=this;b[z](a)[A](a)[B](a)[C](a)},a.prototype.fromJSON=function(b){if(b&&!d.GC$.isEmptyObject(b)){var c=this;a.properties.forEach(function(a){var d,e=b[a];g(e)&&(a.indexOf(l.JLb)>=0?(d=Ba(),d.fromJSON(e),c[a](d,!1)):c[a](e,!1))})}},a.prototype.toJSON=function(){var b=this,c={};return a.properties.forEach(function(a){var d=b[a]();b[a].isDefault(d)||(c[a]=d&&d.toJSON?d.toJSON():d)}),c},a.properties=[u,v,s,z,A,B,C,D],a}(),b.SlicerStyleInfo=ma,na=0,oa=h(ma.properties);na<oa;na++)ma.prototype[ma.properties[na]]=f(ma.properties[na]);function za(a){var b,c;return a&&0!==h(a)?0===a.indexOf(n)?(c=parseInt(a.replace(n,""),10),b=wa[n+c]()):0===a.indexOf(o)?(c=parseInt(a.replace(o,""),10),b=wa[o+c]()):wa[a]&&(b=wa[a]()):b=new ma,b}function Aa(a){var b,c;return a&&0!==h(a)?0===a.indexOf(n)?(c=parseInt(a.replace(n,""),10),b=xa[n+c]()):0===a.indexOf(o)?(c=parseInt(a.replace(o,""),10),b=xa[o+c]()):xa[a]&&(b=xa[a]()):b=new ma,b}for(pa=function(){function a(b,c,d){for(var e=0;e<a.properties.length;e++)this[a.properties[e]](arguments[e])}return a.prototype.fromJSON=function(b){var c,e,f;if(b&&!d.GC$.isEmptyObject(b))for(c=0;c<a.properties.length;c++)e=a.properties[c],f=b[e],g(f)&&(e!==x||""===f||Fa(f)||(f=r),this[e](f,!1))},a.prototype.toJSON=function(){var b,c,d,e={};for(b=0;b<a.properties.length;b++)e[a.properties[b]]=this[a.properties[b]]();c={};for(d in e)e[d]!==j&&e[d]!==i&&(c[d]=e[d]);return c},a.properties=[w,x,y],a}(),b.SlicerBorder=pa,qa=function(a,b,c){return f(a,b,c,function(b){var c=typeof b;return a===w?"number"===c&&b>=0:"string"===c})},na=0;na<pa.properties.length;na++)pa.prototype[pa.properties[na]]=qa(pa.properties[na],j,j);function Ba(a,b,c){return new pa(a,b,c)}function Ca(){var a=new pa(0,"",""),b=new ma(p,q,k);return b.setBorders(a),b}function Da(a){var b=0,c=17,d=16,e=17;return a.indexOf(W+"Light")>-1&&h(a)===c&&(b=parseInt(a[c-1],10)),a.indexOf(W+"Dark")>-1&&h(a)===d&&(b=parseInt(a[d-1],10)),a.indexOf(W+"Other")>-1&&h(a)===e?(b=parseInt(a[e-1],10),b>=1&&b<=2):b>=1&&b<=6}function Ea(a){var b=0,c=21,d=20;return a.indexOf(X+"Light")>-1&&h(a)===c&&(b=parseInt(a[c-1],10)),a.indexOf(X+"Dark")>-1&&h(a)===d&&(b=parseInt(a[d-1],10)),b>=1&&b<=6}function Fa(a){return ja.indexOf(a)>-1}for(ra=function(a,b,c,d){return f(a,b,c,d)},na=1,sa=h(ka.properties);na<sa;na++)ka.prototype[ka.properties[na]]=ra(ka.properties[na]);for(na=1,ta=h(la.properties);na<ta;na++)la.prototype[la.properties[na]]=ra(la.properties[na]);ka.prototype.name=ra(m,""),la.prototype.name=ra(m,"");function Ga(){return new ka}function Ha(){return new la}ua=function(a,b,c,d,e,f,g,h,i,j,k,l,n,o,p,q,r,s,t,u,v,w){var x,y,z=Ga(),A=W+a+b;return z[m](A),x=za(),x.font(c),x.backColor(d),x.setBorders(e),z.wholeSlicerStyle(x),y=za(),y.borderLeft(f),y.borderTop(f),y.borderRight(f),y.borderBottom(g),z.headerStyle(y),z[G](Ja(h,i,j)),z[H](Ja(k,l,n)),z[I](Ja(o,p,q)),z[J](Ja(r,s,t)),Ia(z,Ja(u,v,w)),z},va=function(a,b,c,d,e,f){var g,h,i,j,k,l,n,o,q,r=Ha(),s=X+a+b;return r[m](s),g=Aa(),g.backColor(p),g.setBorders(c),r.wholeSlicerStyle(g),h=Aa(),h.font(ea),r.headerStyle(h),i=Aa(),i.font(fa),i.foreColor(d),r[O](i),j=Aa(),j.foreColor(ha),j.font(ga),r[P](j),k=Aa(),k.foreColor(ha),k.font(ga),r[Q](k),l=Aa(),l.foreColor(ha),l.font(ga),r[R](l),n=Aa(),n.backColor(e),r[S](n),o=Aa(),o.backColor(ia),r[T](o),q=Aa(),q.backColor(f),r[U](q),r};function Ia(a,b){a[K](b)[L](b)[M](b)[N](b)}function Ja(a,b,c){var d=za();return d[v](a)[u](b)[t](c),d}function Ka(a,b){return{degree:90,stops:[{position:0,color:a},{position:1,color:b}]}}function La(){return Ka("#F8E162","#FCF7F4")}function Ma(){return Ka("#A3BBDF","#CADEF6")}function Na(){return Ka("#E8EBEE","#F8F8FA")}function Oa(a){var b=V+a;return ua("Light",a,k,p,Ba(1,r,b),Ba(0,"",""),Ba(1,r,b),q,b+aa,Ba(1,r,Y),Z,b+ba,Ba(1,r,$),q,p,Ba(1,r,$),Z,p,Ba(1,r,"#E0E0E0"),q,La(),Ba(1,r,Y))}function Pa(a){var b=V+a;return ua("Dark",a,k,p,Ba(1,r,b),Ba(0,"",""),Ba(1,r,b),p,b,Ba(1,r,b),b+ca,b+aa,Ba(1,r,b+aa),q,"#C0C0C0",Ba(1,r,"#C0C0C0"),"#959595","#DFDFDF",Ba(1,r,"#DFDFDF"),q,La(),Ba(1,r,Y))}function Qa(a,b){var c=V+b,d="Light"===a?Ka(c+aa,c):Ka(c,c+da);return va(a,b,Ba(1,r,c),c+ca,d,c+_)}for(wa=function(){function a(){}return a}(),b.SlicerStyles=wa,xa=function(){function a(){}return a}(),b.TimelineStyles=xa,ya=1;ya<=6;ya++)wa["light"+ya]=function(a){return function(){return Oa(a)}}(ya),wa["dark"+ya]=function(a){return function(){return Pa(a)}}(ya),xa["light"+ya]=function(a){return function(){return Qa("Light",a)}}(ya),xa["dark"+ya]=function(a){return function(){return Qa("Dark",a)}}(ya);wa.other1=function(){return ua("Other",1,k,p,Ba(1,r,"#808080"),Ba(0,"",""),Ba(1,r,"#A6A6A6"),q,"#BFBFBF",Ba(1,r,Y),q,"#D9D9D9",Ba(1,r,$),q,p,Ba(1,r,$),"#959595",p,Ba(1,r,"#E0E0E0"),q,La(),Ba(1,r,Y))},wa.other2=function(){return ua("Other",2,k,p,Ba(1,r,"#4F81BD"),Ba(0,"",""),Ba(1,r,"#4F81BD"),q,Ma(),Ba(1,r,Y),Z,Ma(),Ba(1,r,$),q,Na(),Ba(1,r,$),Z,Na(),Ba(1,r,"#E0E0E0"),q,La(),Ba(1,r,Y))}},"./dist/plugins/slicer/slicer.entry.js":function(a,b,c){"use strict";function d(a){for(var c in a)b.hasOwnProperty(c)||(b[c]=a[c])}Object.defineProperty(b,"__esModule",{value:!0}),d(c("./dist/plugins/slicer/slicer.ns.js")),c("./dist/plugins/slicer/slicer-actions.js"),d(c("./dist/plugins/slicer/slicer.js")),d(c("./dist/plugins/slicer/table-slicer.js")),d(c("./dist/plugins/slicer/slicer-style.js"))},"./dist/plugins/slicer/slicer.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A;Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e=c("Common"),f=c("FloatingObject"),g=c("./dist/plugins/slicer/slicer.ns.js"),h=new e.Common.ResourceManager(g.SR),i=h.getResource.bind(h),j=e.Common.D,k=e.Common.j,l=k.Fa,m=e.Common.k,n=m.ac,o=null,p=void 0,q="undoAdd",r="undoRemove",s="undoFilter",t="undoUpdateTableSlicer",u=d.UsedRangeUtil.y7c,function(a){a.table="table",a.pivotTable="pivot",a.pivotTimeline="timeline"}(v=b.SlicerType||(b.SlicerType={})),function(a){a[a.years=1]="years",a[a.quarters=2]="quarters",a[a.months=3]="months",a[a.days=4]="days"}(w=b.TimelineLevel||(b.TimelineLevel={}));function B(a){var b=a;return l(a)||0===a?b=v.table:1===a&&(b=v.pivotTable),b}x=function(){function a(a){var b=this;b.kj=a,b.VX=[],b.WX={}}return a.prototype.getUsedRange=function(){var a,b,c,d,e,f,g,h=this,i=h.all(),j={};if(i)for(a=void 0,b=void 0,c=void 0,d=void 0,e=0,f=i;e<f.length;e++)g=f[e],a=g.startRow(),b=g.startColumn(),c=g.endRow(),d=g.endColumn(),u(j,{minRow:a,minCol:b,maxRow:c,maxCol:d});return j},a.prototype.no=function(){var a=this;a.WX&&(d.GC$.each(a.WX,function(a,b){b.no()}),a.WX=o),a.VX=[],a.kj=o},a.prototype.add=function(a,b,c,e,f){var g,h,i,j=this,k=j.kj,l={};if(!D(j,a,l))throw l.error;return k.suspendPaint(),f=B(f),g={slicer:o,slicerName:a,targetName:b,itemName:c,sheet:k,type:f},d.Worksheet.ao(k,"slicerAdding",g),(h=g.slicer)?(e&&h.style(e),j.Cz(h),i={slicer:h},d.Worksheet.ao(k,"slicerAdded",i),k.resumePaint(),h):void k.resumePaint()},a.prototype.Cz=function(a){var b=this,c=b.kj;a&&(b.WX[a.name()]=a,c.ITa.xVa(b,q,a.name(),a))},a.prototype.get=function(a){return a===o||a===p?o:this.WX[a]},a.prototype.remove=function(a){var b=this;b.vV(a)},a.prototype.vV=function(a,b){var c,e=this,f=e.kj,g=e.WX,h=e.get(a);h&&j(g,a)&&(c={slicer:h,ignoreModel:b},d.Worksheet.ao(f,"slicerRemoved",c),delete e.WX[a])},a.prototype.U3=function(a,b){var c,e,f=this,g=f.kj,h={};if(!D(f,b,h))throw h.error;c=f.WX[a],c&&(delete f.WX[a],f.WX[b]=c,e={oldName:a,newName:b,slicer:c},d.Worksheet.ao(g,"slicerRenamed",e))},a.prototype.clear=function(){var a=this,b=a.kj;b.suspendPaint(),d.GC$.each(this.WX,function(b,c){a.remove(c.name())}),b.resumePaint()},a.prototype.all=function(a,b){var c={targetName:a,itemName:b,slicers:[]};return d.Worksheet.ao(this.kj,"getAllSlicers",c),c.slicers},a.prototype.tTa=function(a,b,c){f.FloatingObjectCollection.prototype.tTa.call(this,a,b,c)},a.prototype.XX=function(){return this.WX},a.prototype.HS=function(a){var b,c,d,e=C(this);if(!j(e,a))return a;for(b=1,c=" ",d=a.split(c)[0];j(e,d+c+b);)b++;return d+c+b},a.prototype.UX=function(){var a,b,c,e=this,f=e.WX;if(!f||d.GC$.isEmptyObject(f))return[];a=[];for(b in f)j(f,b)&&(c=f[b],c&&c.isSelected()&&a.push(c));return a},a.prototype.W3=function(a){var b,c,d=this,e=d.UX();if(1!==n(e))return!1;if(b=e,n(b)>0){for(c=0;c<n(b);c++)b[c].Rw&&b[c].Rw(a);return!0}return!1},a.prototype.toJSON=function(a){var b,c=this,e=[],f=c.WX;if(f&&!d.GC$.isEmptyObject(f))for(b in f)j(f,b)&&e.push(f[b].toJSON(a));return e},a.prototype.fromJSON=function(a){var b,c,e,f;if(a&&0!==n(a))for(b=this,c=b.kj,b.WX={},e=0;e<n(a);e++)f=a[e],f.type=B(f.type),d.Worksheet.ao(c,"slicerFromJson",{slicerJSON:f,sheetName:c.name()})},a}(),b.SlicerCollection=x;function C(a){var b,c,d,e=a.kj,f={},g=e&&e.parent&&e.parent.sheets;if(g)for(b=0;b<n(g);b++){c=g[b].slicers.XX();for(d in c)j(c,d)&&(f[d]=c[d])}return f}function D(a,b,c){var d;return b?j(C(a),b)&&(d=i().Exp_SlicerNameExist):d=i().Exp_SlicerNameInvalid,d&&c&&(c.error=Error(d)),!d}function E(a){var b,c,d,e,f;if(!a)return!1;if(b=this,c=b.ZX,a===b.name())return!1;if(c&&(d=c.OW(),e=d&&d.slicers,e&&(f={},!D(e,a,f))))throw f.error;return!0}b.checkSlicerName=E;function F(a,b){var c,d,e,f,g,h,i,j=a.sheets;for(d=0,e=j;d<e.length;d++)for(f=e[d],c=f.slicers.all(),g=0,h=c;g<h.length;g++)if(i=h[g],i.name().toLowerCase()===b.toLowerCase())return!0;return!1}b.h$c=F;function G(a){var b,c,d,e=a.tables.all();for(b=0,c=e;b<c.length;b++)d=c[b],d.KXc=o}function H(a){var b,c,d,e;if(a.pivotTables)for(b=a.pivotTables.all(),c=0,d=b;c<d.length;c++)e=d[c],e.i$c=o}y={priority:900,init:function(){var a=this;a.slicers=new x(a)},dispose:function(a){a.clearCache!==!1&&(this.slicers&&(this.slicers.no(),this.slicers=o),this.unbind("tableRemoved"))},getUsedRange:function(a){var b,c,e;a.type&d.UsedRangeType.slicer&&(b=this,c=b.slicers,e=c.getUsedRange(),u(a.range,e))},toJson:function(a,b){var c,d=b&&b.ignoreStyle,e=b&&b.newWorkSheetName;d||(c=this.slicers.toJSON(e),c.length>0&&(a.slicers=c)),G(this),H(this)},fromJson:function(a,b,c,d,e){var f,g,h,i,j=c&&c.ignoreStyle;if(!j&&(f=this,g=f.parent,!l(g)&&!e&&(h=a&&a.slicers,h&&h.length>0))){if(i=h[0].name,F(g,i))return;f.slicers.fromJSON(h)}},preProcessMouseWheel:function(a){var b=this.slicers;b&&b.W3(a.e)&&(a.r=!0)},onGroupChanged:function(a){this.slicers.tTa(a.start,a.end,a.isRow)}},d.Worksheet.$n("slicer",y),z=function(a){var b="unfilterSlicerByKey",c="filterSlicer",e="unfilterSlicer",f="changeSlicerProperty";a.register(b,d.Commands[b],67,!1,!1,!0,!1),a.register(c,d.Commands[c]),a.register(e,d.Commands[e]),a.register(f,d.Commands[f])},A={init:function(){z(this.commandManager()),this.nameInFormulas={}},fromJson:function(a,b,c){var d,e,f,g,h,i,j=c&&c.ignoreStyle;if(!j)for(d=this,e=0,f=d.getSheetCount();e<f;e++)g=d.getSheet(e),h=a.sheets&&a.sheets[g.name()],i=h&&h.slicers,i&&g.slicers.fromJSON(i)},onCommandExecuting:function(a){var b=a.slicers.all();b.forEach(function(a){a.isSelected(!1)})},dispose:function(){this.nameInFormulas=o}},d.Workbook.$n("slicer",A),d.GC$.extend(d.Workbook.prototype,{j$c:function(a,b){var c=i().SlicerNameInFormula+"_"+a;return this.nameInFormulas[c]&&this.nameInFormulas[c]!==b?this.j$c(a+"1",b):(this.nameInFormulas[c]=b,c)},k$c:function(a,b){return this.nameInFormulas[a]&&this.nameInFormulas[a]!==b}}),d.GC$.extend(d.lUa.prototype,{xVa:function(a,b,c,d){var e,f=this.zTa;f&&(e=f.slicerChanges,e||(e=f.slicerChanges=[]),e.push({slicerItem:a,name:b,value:c,newValue:d}))},yVa:function(a){var b,c,e,f,g,h,i,j,k,l,m,n;if(a)for(b=a.length-1;b>=0;b--)if(c=a[b],e=c.slicerItem,f=c.name,g=c.value,f===s)h=g.columnName,i=g.oldValue,e.doFilter(h,{exclusiveRowIndexes:i});else if(f===q)e.vV(g);else if(f===r){if(!g)return;g.g3?(e.Cz(g),j=g.ZX.MX,j&&(k=j.indexOf(g),k>=0&&j.splice(k,1))):(l=this.kj,m=g.slicerJSON,n=g.cacheJSON,m.type=B(m.type),d.Worksheet.ao(l,"slicerFromJson",{slicerJSON:m,cacheJSON:n,sheetName:l.name()}))}else if(f===t){if(!g)return;this.kj.t4(g.row,g.col,g.rowCount,g.colCount,g.sheetArea)}else e[f](g)}}),d.lUa.$n("SLICER_PROPERTYCHANGE",{priority:5500,undo:function(a){var b=a.slicerChanges;b&&this.yVa(b)}})},"./dist/plugins/slicer/slicer.ns.js":function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0});var d=c("./dist/plugins/slicer/slicer.res.en.js");b.SR={en:d}},"./dist/plugins/slicer/slicer.res.en.js":function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.Blank="(blank)",b.Exp_SlicerNameInvalid="The slicer name is not valid.",b.Exp_SlicerNameExist="The slicer name is already in use; please enter a unique name.",b.SlicerNameInFormula="Slicer"},"./dist/plugins/slicer/table-slicer.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la,ma,na,oa,pa,qa,ra,sa,ta,ua,va,wa,xa,ya,za,Aa,Ba,Ca,Da,Ea,Fa,Ga,Ha,Ia,Ja,Ka,La,Ma,Na,Oa,Pa,Qa,Ra,Sa,Ta,Ua,Va,Wa,Xa,Ya,Za,$a,_a,ab,bb,cb,db,eb,fb,gb,hb,ib,jb,kb,lb,mb,nb,ob,pb,qb,rb,sb,tb,ub,vb,wb,xb,yb,zb,Ab,Bb,Cb,Db,Eb,Fb,Gb,Hb=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e=c("Common"),f=c("FloatingObject"),g=c("ConditionalFormatting"),h=c("Tables"),i=c("./dist/plugins/slicer/slicer.ns.js"),j=c("./dist/plugins/slicer/slicer.js"),k=c("./dist/plugins/slicer/slicer-style.js"),l=new e.Common.ResourceManager(i.SR),m=l.getResource.bind(l),n=e.Common.D,o=e.Common.j,p=o.Fa,q=e.Common.k,r=d.Ul.Nl,s=d.Ul.Pl,t=q.ac,u=d.Ul.hZa,v=d.GC$.isArray,w=d.GC$.extend,x=document,y=void 0,z=null,A="normal 11pt calibri",B=parseFloat,C=".slicer",D="mouse",E="wheel",F="DOMMouseScroll",G=e.Slicers.GeneralSlicerData,function(a){a[a.CONTAINER=0]="CONTAINER",a[a.H_SPACE=1]="H_SPACE",a[a.H_CAPTION=2]="H_CAPTION",a[a.H_SPLITLINE=3]="H_SPLITLINE",a[a.H_CLEARFILTER=4]="H_CLEARFILTER",a[a.B_ITEM=5]="B_ITEM",a[a.B_ITEMSPACER=6]="B_ITEMSPACER",a[a.B_TAIL=7]="B_TAIL",a[a.B_SCROLLBAR=8]="B_SCROLLBAR"}(H||(H={})),function(a){a[a.HOVERED=1]="HOVERED",a[a.SELECTED=2]="SELECTED",a[a.UNSELECTED=4]="UNSELECTED",a[a.HASDATA=8]="HASDATA",a[a.NODATA=16]="NODATA"}(I||(I={})),function(a){a[a.NORMAL=0]="NORMAL",a[a.ACTIVE=1]="ACTIVE",a[a.HOVERED=2]="HOVERED"}(J||(J={})),K={GLb:"Style",HLb:"Color",ILb:"Width",JLb:"border",KLb:"WithDataStyle",LLb:"WithNoDataStyle",MLb:"electedItem",NLb:"hovered",OLb:"top",PLb:"gc-slicer-",QLb:"container",RLb:"header",SLb:"clearfilter",TLb:"body",ULb:"itemscontainer",VLb:"item"},L="name",M="style",N="white",O="black",P="solid",Q="color",R="background-color",S="width",T="height",U="font",V="back"+K.HLb,W="fore"+K.HLb,X=K.JLb+"Width",Y=K.JLb+K.GLb,Z=K.JLb+K.HLb,$=K.JLb+"Left",_=K.JLb+"Top",aa=K.JLb+"Right",ba=K.JLb+"Bottom",ca="textDecoration",da="wholeSlicer"+K.GLb,ea="header"+K.GLb,fa="s"+K.MLb+K.KLb,ga="s"+K.MLb+K.LLb,ha="unS"+K.MLb+K.KLb,ia="unS"+K.MLb+K.LLb,ja=K.NLb+"S"+K.MLb+K.KLb,ka=K.NLb+"S"+K.MLb+K.LLb,la=K.NLb+"UnS"+K.MLb+K.KLb,ma=K.NLb+"UnS"+K.MLb+K.LLb,na="undoFilter",oa="undoUpdateTableSlicer",pa="div",qa="px",ra="default",sa="cursor",ta="position",ua="absolute",va="padding",wa="margin-"+K.OLb,xa="left",ya="right",za="text-align",Aa="overflow",Ba="hidden",Ca="auto",Da="text-overflow",Ea="ellipsis",Fa="white-space",Ga="nowrap",Ha="unselectable",Ia="on",Ja="font-weight",Ka="font-size",La="border-radius",Ma="box-sizing",Na="content-box",Oa="button",Pa="\u2717",Qa="mark",Ra="itemValue",Sa=K.PLb+K.QLb,Ta=K.PLb+K.RLb,Ua=K.PLb+"header-borderDiv",Va=K.PLb+"caption",Wa=K.PLb+K.SLb,Xa=K.PLb+K.TLb,Ya=K.PLb+"table",Za=K.PLb+"tr",$a=K.PLb+"td1",_a=K.PLb+"td2",ab=K.PLb+K.ULb,bb=K.PLb+K.VLb,cb="gc-no-user-select";function Ib(a,b){var c,d,e,f,g,h,i=a.KW,j=a._caption,k=Mb(a.slicerData),l=a.zoomFactor();if(b){b[da]&&(Pb(a.xo,b[da],k,j,l),mc(a,K.QLb)),c=a.LW,d=Kb(b[da],b[ea]),Qb(b)?(e=d[ba],f=e&&e[X]||0,c[M][T]=(a.MW-f)*Rb(b)*l+qa,Ob(c,e,k,ba),d[$]=d[_]=d[aa]=d[ba]=z):(c[M][ba+S]=0+qa,c[M][T]=i[M][T]),Pb(i,d,k,j,l),mc(a,K.RLb);for(g in a.NW)n(a.NW,g)&&(h=parseInt(g,10),jc(a,h))}}function Jb(a,b,c){var e,f,g={};if(b&&c&&t(b)===t(c)){for(e=0,f=t(b);e<f;e++)g[b[e]]=c[e];d.GC$(a).css(g)}}function Kb(a,b){var c={},d;if(b)for(d in b)n(b,d)&&(c[d]=b[d]);if(a)for(d in a)c[d]===y&&a[d]!==y&&(c[d]=a[d]);return c}function Lb(a,b){var c;if("string"==typeof a){if(!b)return a;a&&b.getColor&&(c=b.getColor(a))}else"object"==typeof a&&(c=b.getColor(a.stops[0].color));return c}function Mb(a){var b=a&&a.OW&&a.OW();return b&&b.currentTheme()}function Nb(a){switch(a){case"double":return"double";case"dashDot":case"dashDotDot":case"dotted":case"slantedDashDot":case"mediumDashDot":case"mediumDashDotDot":return"dotted";case"medium":case"dashed":case"mediumDashed":return"dashed";default:return"solid"}}function Ob(a,b,c,d){if(a){var e=b&&b[X]||0,f=b&&b[Y]||"",g=b&&b[Z]||"";a[M][d+K.ILb]=e+qa,a[M][d+K.GLb]=Nb(f),a[M][d+K.HLb]=Lb(g,c)}}function Pb(a,b,c,f,g){var h,i,j,k;a&&b&&(h=b[W]||O,i=b[V]||N,j=b[U]||A,a[M][R]=Lb(i,c),a[M][Q]=Lb(h,c),a[M][U]=u(d.To.No(j,g)[U]),Ob(a,b[$],c,$),Ob(a,b[_],c,_),Ob(a,b[aa],c,aa),Ob(a,b[ba],c,ba),k=d.To.So(b[ca]),e.Common.u.Bb(a.className,Ta)?f[M][ca]=k:e.Common.u.Bb(a.className,bb)&&(a[M][ca]=k))}function Qb(a){var b,c=a[ea];return!c||!(c[$]||c[_]||c[aa]||c[aa])||(b=Kb(a[da],c),!(!(b[ba]&&b[ba][X]>0)||b[$]&&0!==b[$][X]||b[_]&&0!==b[_][X]||b[aa]&&0!==b[aa][X]))}function Rb(a){var b,c,e,f,g,h,i,j,k;return a?(b=Kb(a[da],a[ea]),b&&b[U]?(c=b[U],e=1,f=d.To.Ko,g=d.To.Jo,h=f(g(A)).fontSize,i=f(g(c)).fontSize,h&&i&&(j=B(h),k=B(i),isNaN(k)||(e=k/j)),e):1):1}function Sb(a){var b,c,d,e,f,g=0,h=0;return a&&(b=a[M],c=b[$+K.ILb],d=b[_+K.ILb],e=b[aa+K.ILb],f=b[ba+K.ILb],c&&(g+=B(c)),d&&(h+=B(d)),e&&(g+=B(e)),f&&(h+=B(f))),{widthOffset:g,heightOffset:h}}function Tb(a){var b,c,d=[];if(a)for(c=0;c<t(a);c++)b=a[c]===y||a[c]===z||""===a[c]?m().Blank:a[c]+"",d.push(b);return d}function Ub(a){var b=r(pa);return Jb(b,[ta,va,Ma,Aa],[ua,6*a.zoomFactor(),Na,Ba]),d.GC$(b).addClass(Sa),mc(a,K.QLb),d.GC$(b).append(Vb(a)).append(Wb(a)),b}function Vb(a){var b,c,e,f,g,h,i,j,k=r(pa),l=r(pa),m=r("span"),n=r(pa),o=a.zoomFactor(),p=a.style();return Jb(k,[S,ta,K.OLb,xa,ya,Ma,Aa],[Ca,ua,0,0,0,Na,Ba]),d.GC$(k).addClass(Ta),a.KW=k,b=a.PW*o,Jb(l,[S,ta,xa,ya,Ma,Aa],[Ca,ua,b,b,Na,Ba]),d.GC$(l).addClass(Ua),a.LW=l,d.GC$(k).append(l),c=a.QW*Rb(p)*o,e=Zb(a)*o,Jb(m,[Ma,ta,K.OLb,Aa,S,Da,Fa],[Na,ua,c,Ba,e,Ea,Ga]),d.GC$(m).text(a.captionName()).attr(Ha,Ia).addClass(Va+" "+cb),a._caption=m,f=a.RW*o,g=a.SW*o,h=a.TW*Rb(p)*o,i=a.UW*o,j=a.VW*o+qa,Jb(n,[S,T,sa,ta,K.OLb,ya,za,Ma,Ja,La,Aa,Ka],[f,g,ra,ua,h,i,"center",Na,"normal",2,Ba,j]),d.GC$(n).attr("title","Clear Filter (Alt+C)").attr(Ha,Ia).text(Pa).addClass(Wa+" "+cb),a.WW=n,mc(a,K.RLb),d.GC$(l).append(m).append(n),k}function Wb(a){var b,c=r(pa),e=r("table"),f=r("tr"),g=r("td"),h=r("td"),i=(a.MW-a.PW+a.XW)*Rb(a.style())*a.zoomFactor();return Jb(c,[S,Aa,wa,Ma],[Ca,Ba,i,Na]),d.GC$(c).attr(Ha,Ia).addClass(Xa+" "+cb),a.YW=c,Jb(e,[Ma,"border-spacing"],[Na,0+qa]),d.GC$(e).attr(Ha,Ia).addClass(Ya+" "+cb),a.ZW=e,d.GC$(f).css(Ma,Na).addClass(Za),a.$W=f,Jb(g,[va,Ma],[0,Na]),d.GC$(g).addClass($a),a._W=g,Jb(h,[va,Ma,sa],[0,Na,ra]),d.GC$(h).addClass(_a),a.aX=h,d.GC$(g).append(Xb(a)),b=dc(a),d.GC$(h).append(b),a.bX=b,d.GC$(f).append(g).append(h),d.GC$(e).append(f),d.GC$(c).append(e),c}function Xb(a){var b,c,e,f,g,h,i,j=r(pa),k=a.zoomFactor();for(a.cX=j,c=$b(a),a.dX=c,b=_b(a),a.eX=b,Jb(j,[S,T,Ka],[b*k,c*k,a.VW*k+qa]),d.GC$(j).attr(Ha,Ia).addClass(ab+" "+cb),e=cc(a),a.fX=e,f=Math.min(bc(a),t(e)),g=0;g<f;g++)h=e[g],i=Yb(a,h,g),d.GC$(j).append(i),a._items.push(i),a.NW[a.gX.indexOf(h)]=i;return j}function Yb(a,b,c){var e,f,g=b,h=r(Oa),i=a.zoomFactor(),j=a.hX*i+qa;return Jb(h,[za,Fa,wa,sa,Ma,La,va,Aa,Da,R],[xa,Ga,j,ra,Na,5,"1px 6px",Ba,Ea,N]),d.GC$(h).attr("type",Oa).attr(Ha,Ia).text(g).addClass(bb+" "+cb),e=a.slicerData.kj,e&&(f=e.parent),f&&f.options.enableAccessibility&&d.GC$(h).attr("tabindex",-1),(c+1)%a.columnCount()!==0&&d.GC$(h).css("margin-right",a.hX*i+qa),mc(a,K.VLb,h),h}function Zb(a){var b,c,d=a.xo,e=a.KW,f=1,g=1,h=0,i=0,j=function(a){return a?B(a):0},k=K.JLb+"Left"+K.ILb,l=K.JLb+"Right"+K.ILb;return d&&(b=d.style,f=j(b[k]),g=j(b[l])),e&&(c=e.style,h=j(c[k]),i=j(c[l])),a.width()-(f+g)-2*a.PW-(h+i)-a.RW}function $b(a){var b=Sb(a.xo),c=a.height()-2*a.PW-b.heightOffset;return a.showHeader()?c-a.MW*Rb(a.style())-a.XW:c}function _b(a){var b=Sb(a.xo),c=a.width()-2*a.PW-b.widthOffset-1;return a.iX()?c-a.jX:c}function ac(a,b){var c=a.columnCount();return(b-(c-1)*a.hX)/c}function bc(a){return Math.ceil(a.dX/(a.itemHeight()+2*(a.kX+a.lX)+a.hX))*a.columnCount()}function cc(a){var b,c,d,e,f,g,h=a.gX,i=a.mX(h.slice(0),a.sortState()),j=a.slicerData.getFilteredOutIndexes(a.columnName,2);if(a.showNoDataItems()){if(a.visuallyNoDataItems()&&a.showNoDataItemsInLast()){for(b=[],d=t(i),e=void 0,f=void 0,e=0;e<d;e++)f=i[e],q.Bb(j,h.indexOf(f))||b.push(f);for(e=0;e<d;e++)f=i[e],q.Bb(j,h.indexOf(f))&&b.push(f);i=b}}else for(b=i.concat(),c=0;c<t(b);c++)q.Bb(j,h.indexOf(b[c]))&&q.Fb(i,b[c]);return g=m().Blank,q.Bb(i,g)&&(q.Fb(i,g),i.push(g)),i}function dc(a){var b,c=new d.hv((!1));return a.nX=c,b=c.Bv(),d.GC$(b).bind("scroll.gcScrollbar",function(b,c){var d,e=c.scrollEventType,f=c.scrollOrientation;b.data=a,1===f&&(d=[0,1,2,3,5],d.indexOf(e)>=0&&a.Bw(b,c))}),b}function ec(a){var b=a.slicerData;a.data=b.getData(a.columnName),a.exclusiveDatas=b.getExclusiveData(a.columnName),a.oX=Tb(a.data),a.gX=Tb(a.exclusiveDatas),a.fX=cc(a),lc(a),ic(a)}function fc(a,b){var c,e=a.style(),f=a.xo;f&&(b!==y&&b!==a.zoomFactor()&&(a.zoomFactor(b),Ib(a,e)),d.GC$(f).css(va,6*b),mc(a,K.QLb),gc(a),c=a.showHeader()?(a.MW+a.XW-a.PW)*Rb(e)*b:0,d.GC$(a.YW).css(wa,c),hc(a),lc(a))}function gc(a){var b,c,e,f,g,h,i,j,k,l,m=a.zoomFactor(),n=a.KW,o=a.YW,p=a._caption,q=a.WW,r=a.style();a.showHeader()?(a.xo.firstChild!==n&&(d.GC$(n).insertBefore(o),d.GC$(o).css(wa,(a.MW+a.XW)*Rb(r)*m)),d.GC$(n).css(T,a.MW*Rb(r)*m),b=a.PW*m,Jb(a.LW,[xa,ya],[b,b]),p.innerHTML!==a.captionName()&&d.GC$(p).text(a.captionName()),c=a.QW*Rb(r)*m,e=Zb(a)*m,Jb(p,[K.OLb,S,Ja],[c,e,"bold"]),f=a.pX,g=f&&t(f)>0?1:0,uc(a,g),h=a.RW*m,i=h,j=a.TW*Rb(r)*m,k=a.UW*m,l=a.VW*m+qa,Jb(q,[S,T,K.OLb,ya,Ka],[h,i,j,k,l]),mc(a,K.RLb)):d.GC$(n).remove()}function hc(a){var b,c=a.zoomFactor(),d=$b(a);a.dX=d,b=_b(a),a.eX=b,Jb(a.cX,[S,T,Ka],[b*c,d*c,a.VW*c]),ic(a)}function ic(a){var b,c,e,f,g,h,i,j,k=a.fX;if(k){for(b=a._items,b&&t(b)>0&&d.GC$(b).remove(),a._items=[],b=a._items,a.NW={},c=Math.min(bc(a),t(k)),e=a.iX()?a.nX.value()*a.columnCount():0,f=Math.min(e+c,t(k)),g=e;g<f;g++)h=k[g],i=Yb(a,h,g),d.GC$(a.cX).append(i),b.push(i),a.NW[a.gX.indexOf(h)]=i;if(0!==t(b))for(j in a.NW)n(a.NW,j)&&jc(a,parseInt(j,10))}}function jc(a,b){var c=a.qX,d=c?a.gX.indexOf(c[Ra]):-1,e=a.pX,f=a.rX,g=a.NW[b],h=0;b===d&&(h|=1),h|=q.Bb(e,b)?4:2,h|=q.Bb(f,b)&&a.visuallyNoDataItems()?16:8,kc(a,g,h)}function kc(a,b,c){var d=a.style(),e;if(b&&d){switch(c){case 10:e=fa;break;case 18:e=ga;break;case 12:e=ha;break;case 20:e=ia;break;case 11:e=ja;break;case 19:e=ka;break;case 13:e=la;break;case 21:e=ma}Pb(b,Kb(d[da],d[e]),Mb(a.slicerData),a._caption,a.zoomFactor()),mc(a,K.VLb,b)}}function lc(a){var b,c,e,f,g,h=a.bX,i=a.aX;a.iX()?(h||(h=dc(a)),i.firstChild!==h&&(d.GC$(i).append(h),hc(a)),b=a.zoomFactor(),c=a.dX,e=Math.floor(c/(a.itemHeight()+2*a.kX+a.hX)),f=a.nX,f.value(a.sX),f.Vo(a.jX*b,!1),f._v(c*b,!1),f.bw(0),f.cw(Math.ceil(t(a.gX)/a.columnCount())-e),f.dw(e),f.qB(1),f.rB(e-1),f.ew()):(i.firstChild===h&&(g=h.parentElement,g&&g.removeChild(h),hc(a)),a.sX=0)}function mc(a,b,c){var e,f,g,h,i,j,k,l,m,n,o=a.zoomFactor();switch(b){case K.QLb:h=a.xo,i=Sb(h),j=a.PW,e=(a.width()-2*j)*o-i.widthOffset,f=(a.height()-2*j)*o-i.heightOffset,g=h;break;case K.RLb:k=a.KW,l=Sb(k),m=a.MW*Rb(a.style())*o-l.heightOffset,d.GC$(k).css(T,m),e=a.RW*o,f=a.SW*o,g=a.WW;break;case K.VLb:n=Sb(c),e=ac(a,a.eX)*o-2*a.tX-n.widthOffset,f=a.itemHeight()*o-n.heightOffset,g=c}Jb(g,[S,T],[e,f])}function nc(a,b){var c,d,e,f=a.exclusiveDatas,g=a.pX,h=rc(a,b[Ra]),i=a.vX,j=a.wX;for(q.Bb(i,h)?q.Fb(i,h):i.push(h),c=0;c<t(f);c++)q.Bb(g,c)||j.push(c);for(d=0;d<t(i);d++)q.Bb(j,i[d])?q.Fb(j,i[d]):j.push(i[d]);
if(0===t(j))for(e=0;e<t(a.gX);e++)j.push(e);a.xX=h}function oc(a,b){var c,d,e,f,g,h,i,j,k=a.fX,l=a.gX,m=l[a.xX];for(qc(a),c=k.indexOf(m),d=k.indexOf(b[Ra]),e=Math.min(c,d),f=Math.max(c,d),g=e;g<=f;g++)h=l.indexOf(k[g]),i=a.vX,j=a.wX,i.indexOf(h)===-1&&i.push(h),j.indexOf(h)===-1&&j.push(h)}function pc(a,b){qc(a);var c=rc(a,b[Ra]);jc(a,c),a.vX.push(c),a.wX.push(c),a.xX=c}function qc(a){var b,c,d,e,f,g,h=a._items;if(h&&0!==t(h))for(b=a.rX,c=0,d=t(h);c<d;c++)e=h[c],f=a.gX.indexOf(h[c].innerHTML),g=q.Bb(b,f)?20:12,kc(a,e,g)}function rc(a,b){var c,d,e=a.gX;if(e)for(c=0,d=t(e);c<d;c++)if(e[c]===b)return c;return-1}function sc(a,b){var c,d,e=a.pX,f=a.rX;for(c=0;c<t(b);c++)d=0,d|=a.yX?q.Bb(e,b[c])?2:4:2,d|=q.Bb(f,b[c])&&a.visuallyNoDataItems()?16:8,kc(a,a.NW[b[c]],d)}function tc(a,b){var c=a.qX;a.CD(b),c=c?new hb(c[Qa],c[Ra]):z,a.qX=z,vc(a,c)}function uc(a,b){var c,e,f,g=a.WW;if(g)switch(c=a.style(),e=Kb(c[da],c[ea]),f=e&&e[V],f||(f=N),a.zX=f,b){case 0:a.AX=!1,Jb(g,[Q,R],[a.BX,f]);break;case 1:a.AX=!0,Jb(g,[Q,R],[a.CX,f]);break;case 2:d.GC$(g).css(R,a.DX)}}function vc(a,b){var c,d;if(b)switch(c=a.vX,b[Qa]){case 4:if(!a.WW)return;a.AX?uc(a,1):uc(a,0);break;case 5:d=a.gX.indexOf(b[Ra]),c&&q.Bb(c,d)?sc(a,c):jc(a,d)}}function wc(a,b){if(b)switch(b[Qa]){case 4:if(!a.WW||!a.AX)return;uc(a,2);break;case 5:var c=a.gX.indexOf(b[Ra]);jc(a,c);break;case 6:a.cX.style.cursor=ra}}function xc(a,b){var c,d,e=a._items;if(e&&b!==z)for(c=0;c<t(e);c++)if(d=e[c],d.innerHTML.toLowerCase()===b.toLowerCase())return d;return z}function yc(a,b){var c,d,e,f,g,h,i,j,k,l,m,n=zc(a,K.QLb),o=z,p=z;if(!n)return z;if(c=b.pageX,d=b.pageY,e=zc(a,K.RLb),f=zc(a,K.SLb),g=zc(a,K.TLb),h=zc(a,K.ULb),e&&e.contains(c,d))o=f&&f.contains(c,d)?4:1;else if(g&&g.contains(c,d))if(i=a._items,h&&h.contains(c,d)&&i){for(j=void 0,j=0;j<t(i);j++)if(k=zc(a,K.VLb,j),k&&k.contains(c,d)){o=5;for(l in a.NW)if(a.NW[l]===i[j]){p=a.gX[l];break}break}j>=t(i)&&(m=zc(a,K.VLb,t(i)-1),o=m&&d<m.y+a.itemHeight()*a.zoomFactor()?6:7)}else o=8;else o=0;return new hb(o,p)}function zc(a,b,c){var e,f,g,h,i,j,k,l,m,n,o,p=b===K.QLb?y:zc(a,K.QLb),q=a.xo,r=a.EX,s=a.PW,u=a.zoomFactor(),v=a.style(),w=a.showHeader(),x=a.MW,A=a.RW,B=a.gX;switch(b){case K.QLb:e=0,f=0,g=q.offsetWidth,h=q.offsetHeight;do e+=q.offsetLeft,f+=q.offsetTop,q=q.offsetParent;while(q);break;case K.RLb:if(!p||!w)return z;e=p.x+r*u,f=p.y+r*u,g=a.width()*u,h=x*Rb(v)*u;break;case K.SLb:if(!p||!w)return z;e=p.x+p.width-(r+s+A)*u,f=p.y+r+a.QW*Rb(v)*u,g=A*u,h=a.SW*u;break;case K.TLb:if(!p)return z;i=r+s,j=0,k=x*Rb(v)+a.XW,e=p.x+i*u,f=p.y+j*u+(w?k*u:0),g=(a.width()-2*i)*u,h=p.height-2*j*u-(w?k*u:0);break;case K.ULb:if(l=zc(a,K.TLb),!l)return z;if(!a.iX())return l;e=l.x,f=l.y,g=l.width-a.jX*a.zoomFactor(),h=l.height;break;case K.VLb:if(!p||0===t(B)||c>=t(B))return z;if(m=zc(a,K.ULb),!m)return z;n=a.columnCount(),o=a.hX,g=(m.width-(n-2)*o*u)/n,h=a.itemHeight()*u+2*a.lX,e=m.x+c%n*(g+o*u),f=m.y+Math.floor(c/n)*(h+o*u)}return new d.Rect(e,f,g,h)}function Ac(a){return a>0}db=function(){function a(a,b,c){var d=this;d.name(a,!1),d.xo=z,d.PW=6,d.EX=1,d.VW=14,d.KW=z,d.MW=27,d.XW=5,d._caption=z,d.WW=z,d.RW=28,d.SW=25,d.TW=3,d.UW=0,d.AX=!1,d.QW=3,d.YW=z,d.ZW=z,d.$W=z,d._W=z,d.aX=z,d.cX=z,d.eX=0,d.dX=0,d.bX=z,d.FX=2,d._items=[],d.NW={},d.lX=1,d.kX=1,d.tX=6,d.hX=2,d.jX=17,d.sX=0,d.zX=N,d.DX="#F9E578",d.CX="red",d.BX="#B0ADB0",d.GX=!1,d.HX=!1,d.vX=[],d.wX=[],d.xX=0,d.fX=[],d.pX=[],d.rX=[],d.gX=[],d.oX=[],d.slicerData=b,d.columnName=c,d.data=b.getData(c),d.exclusiveDatas=b.getExclusiveData(c),d.slicerData.attachListener(d),d.IX()}return a.getDefaultStyle=function(){var a=function(a,b,c,d,e,f,g,h){var i={};return i[V]=a,i[W]=b,i[U]=c,i[$]=d,i[_]=e,i[aa]=f,i[ba]=g,i[ca]=h,i},b=function(a,b,c){var d={};return d[X]=a,d[Y]=b,d[Z]=c,d},c=b(1,P,"#808080"),d=b(0,"",""),e=b(1,P,"#999999"),f=b(1,P,"#CCCCCC"),g=b(1,P,"#E0E0E0"),h=a("#F9E36F",O,A,e,e,e,e),i={};return i[da]=a(N,O,A,c,c,c,c),i[ea]=a(N,O,"bold 11pt calibri",d,d,d,b(1,P,"#A6A6A6")),i[fa]=a("#BFBFBF",O,A,e,e,e,e),i[ga]=a("#D9D9D9",O,A,f,f,f,f),i[ha]=a(N,O,A,f,f,f,f),i[ia]=a(N,"#959595",A,g,g,g,g),i[ja]=h,i[ka]=h,i[la]=h,i[ma]=h,i},a.prototype.IX=function(){var a=this;a.oX=Tb(a.data),a.gX=Tb(a.exclusiveDatas),a.xo=Ub(a),a.captionName(a.columnName,!1),a.attachEvents(),a.onFiltered(),Ib(a,a.style()),fc(a)},a.prototype.attachEvents=function(){var a,b=this,c=b.xo;c&&(d.GC$(c).bind(D+"down"+C,function(a){b.AD(a)}).bind(D+"move"+C,function(a){b.BD(a)}).bind(D+"out"+C,function(a){b.uX()}),d.GC$(x).bind(D+"up"+C,function(a){tc(b,a)}).bind("keydown"+C,function(a){b.nm(a)}).bind("keyup"+C,function(a){b.om(a)}),b.Rw=b.Rw.bind(b),a={capture:!1,passive:!1},c.addEventListener(D+E,b.Rw,a),c.addEventListener(F,b.Rw,a),x.addEventListener(D+E,b.Rw,a),x.addEventListener(F,b.Rw,a))},a.prototype.detachEvents=function(){var a=this,b=a.xo;b&&(d.GC$(b).unbind(C),d.GC$(x).unbind(C),b.removeEventListener(D+E,a.Rw),b.removeEventListener(F,a.Rw),x.removeEventListener(D+E,a.Rw),x.removeEventListener(F,a.Rw))},a.prototype.no=function(){var a=this;a.detachEvents(),d.GC$(a.xo).remove(),a.xo=z},a.prototype.getDOMElement=function(){return this.xo},a.prototype.mX=function(a,b){var c,d,f=[];if(0!==b){for(c=e.Slicers.jf.quickSort(a),d=0;d<t(c);d++)f[d]=c[d].value;return 2===b&&f.reverse(),f}},a.prototype.iX=function(){var a=this,b=a.gX,c=a.showNoDataItems()?t(b):t(b)-t(a.rX),d=Math.ceil(c/a.columnCount())*(a.itemHeight()+2*(a.lX+a.kX)+a.hX);return d>a.dX},a.prototype.Bw=function(a,b){this.JX(a,b)},a.prototype.JX=function(a,b){var c=this,d=b.newValue;d!==c.sX&&d<=c.nX.cw()&&(c.sX=d,lc(c),ic(c))},a.prototype.onDataChanged=function(){ec(this)},a.prototype.onRowsChanged=function(){ec(this)},a.prototype.onColumnNameChanged=function(a,b){var c=this;c.columnName===a&&c._caption&&(c.columnName=b,c.captionName(b,!1),d.GC$(c._caption).text(b))},a.prototype.onColumnRemoved=function(a){var b=this;a===b.columnName&&(b.slicerData.doUnfilter(a),b.detachEvents(),d.GC$(b.xo).remove(),b.xo=z)},a.prototype.onFiltered=function(){var a=this,b=a.slicerData,c=a.columnName;a.fX=cc(a),a.rX=b.getFilteredOutIndexes(c,2),a.pX=b.getFilteredOutIndexes(c,1),fc(a)},a.prototype.xmb=function(a){var b,c=yc(this,a);return!!c&&(b=c.mark,5===b||6===b||8===b||4===b)},a.prototype.AD=function(a){var b=this,c=yc(b,a);c&&(8===c[Qa]&&(b.HX=!0),5===c[Qa]&&(b.wX=[],b.GX=!0,a.ctrlKey?nc(b,c):a.shiftKey?oc(b,c):pc(b,c)),sc(b,b.vX),(5===c[Qa]||6===c[Qa]||8===c[Qa]||4===c[Qa]&&b.AX)&&a.stopPropagation())},a.prototype.CD=function(a){var b,c,d,e=this,f=yc(e,a);f&&(b=e.slicerData,c=e.vX,d=!1,4===f[Qa]?e.AX&&(b.doUnfilter(e.columnName),uc(e,0),d=!0):c&&t(c)>0&&!e.yX&&!e.KX&&(b.doFilter(e.columnName,{exclusiveRowIndexes:e.wX}),d=!0),e.GX=!1,e.HX=!1,d&&(e.vX=[],e.wX=[]))},a.prototype.BD=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o=this,p=o.qX,r=p?new hb(p[Qa],p[Ra]):z,s=yc(o,a),u=o.gX,v=o.wX;if(s&&(!r||r[Qa]!==s[Qa]||5===r[Qa]&&r[Ra]!==s[Ra])){if(!o.GX)return o.qX=s,vc(o,r),void wc(o,s);if(5===s[Qa])if(b=u.indexOf(s[Ra]),c=o.rX,d=void 0,e=void 0,f=void 0,q.Bb(v,b)){for(g=o.fX,h=g.indexOf(u[o.xX]),i=g.indexOf(s[Ra]),j=Math.min(h,i),k=Math.max(h,i),l=[],m=t(v),d=0;d<m;d++)n=v[d],e=g.indexOf(u[n]),(e>k||e<j)&&l.push(n);for(m=t(l),d=0;d<m;d++)e=l[d],f=xc(o,u[e]),q.Bb(c,e)?kc(o,f,20):kc(o,f,12),q.Fb(v,e)}else f=xc(o,u[b]),q.Bb(c,b)?kc(o,f,18):kc(o,f,10),q.Sb(v,b);o.qX=s}},a.prototype.uX=function(){var a=this,b=a.qX,c=b?new hb(b[Qa],b[Ra]):z;a.qX=z,vc(a,c)},a.prototype.Rw=function(a){var b=yc(this,a);return 8===b[Qa]&&(a.stopPropagation(),!0)},a.prototype.nm=function(a){var b=this;17!==a.keyCode||b.yX||(b.yX=!0),16!==a.keyCode||b.KX||(b.KX=!0)},a.prototype.om=function(a){var b=this,c=b.slicerData;17===a.keyCode&&b.yX&&(b.yX=!1),16===a.keyCode&&b.KX&&(b.KX=!1),!b.yX&&!b.KX&&t(b.vX)>0&&(c.doFilter(b.columnName,{exclusiveRowIndexes:b.wX}),b.vX=[],b.wX=[])},a.prototype.onPropertyChanged=function(a,b,c){var d,e=this;e.slicerData.OW&&(d=e.slicerData.OW(),d.ITa.xVa(e,a,c,b))},a}(),b.ItemSlicer=db;function Bc(a){return function(b,c){fc(this),this.onPropertyChanged(a,b,c)}}function Cc(a){return function(b,c){var d=this;d.fX=cc(d),fc(d),d.onPropertyChanged(a,b,c)}}function Dc(a,b,c,e){return c||(c=Bc(a)),d.Ul.Pl(a,b,c,e)}for(eb=[[L],[S,180],[T,210],["captionName",""],["columnCount",1,z,Ac],["itemHeight",21,z,Ac],["showHeader",!0],["sortState",1,Cc("sortState")],["showNoDataItems",!0,Cc("showNoDataItems")],["showNoDataItemsInLast",!0,Cc("showNoDataItemsInLast")],["visuallyNoDataItems",!0,Cc("visuallyNoDataItems")],[M,db.getDefaultStyle(),function(a,b){Ib(this,a),fc(this),this.onPropertyChanged("visuallyNoDataItems",a,b)}],["zoomFactor",1,z,Ac],["isLocked"],["disableResizingAndMoving"]],fb=0,gb=t(eb);fb<gb;fb++)db.prototype[eb[fb][0]]=Dc(eb[fb][0],eb[fb][1],eb[fb][2],eb[fb][3]);hb=function(){function a(a,b){var c=this;c[Qa]=a===y?z:a,c[Ra]=b===y?z:b}return a}();function Ec(a,b,c){var d,e,f,g,h=a.kj,i=a.dataRange(),j=i.row+i.rowCount-1,k=i.col+i.colCount-1;for(d=i.row;d<=j;d++)for(e=[],b.push(e),f=i.col;f<=k;f++)e.push({value:h.getValue(d,f),text:h.getText(d,f)});for(f=0;f<i.colCount;f++)g=a.getColumnName(f)||"",c.push(g)}function Fc(a,b){var c,d,e=a.kj,f=a.sj.rowFilter();for(e.suspendPaint(),c=f&&f.Je||[],d=0;d<t(c);d++)Gc(a,b,[c[d]]);e.resumePaint()}function Gc(a,b,c){var d,e,f,g,h,i,j,k,l,m,n,o,p,r,s,u;for(d=0;d<c.length;d++){if(e=a.sj,f=a.xr,g=c[d]-e.range().col,h=e.dataRange(),i=g+h.col,j=a.columnNames[g],k=[],l={},q.Bb(f.Je,i)){for(m=[],n=h.row;n<h.row+h.rowCount;n++)f.E0a(n,i)||m.push(n);for(o=0;o<t(m);o++)p=m[o]-h.row,r=a.getExclusiveRowIndex(j,p),l[r]||(l[r]=!0,k.push(r))}else for(s=t(a.getExclusiveData(j)),u=0;u<s;u++)k.push(u);Hc(Ic(a,j),k)||(b.prototype.doFilter.call(a,j,{exclusiveRowIndexes:k}),a.onFiltered(),a.kj.$p())}}function Hc(a,b){if(p(a)&&p(b))return!0;if(p(a)&&!p(b)||!p(a)&&p(b)||!p(a)&&!p(b)&&(!v(a)||!v(b))||a.length!==b.length)return!1;for(var c=0;c<a.length;c++)if(a[c]!==b[c])return!1;return!0}function Ic(a,b){var c,d=a.getExclusiveData(b),e=a.getFilteredOutIndexes(b,1),f=[];for(c=0;c<t(d);c++)q.Bb(e,c)&&f.push(c);return f}ib=function(a){Hb(b,a);function b(b){var c,d=this,e=[],f=[],g=b.rowFilter();return Ec(b,e,f),d=a.call(this,e,f)||this,c=d,c.sj=b,c.kj=b.kj,c.xr=g,c.MX=z,Fc(c,G),g&&(g.filterHandler=function(a){Gc(c,G,a.columns)}),d}return b.prototype.no=function(){var a=this;a.MX=z,a.sj=z,a.xr&&(a.xr.filterHandler=z,a.xr=z),a.kj=z},b.prototype.OW=function(){return this.kj},b.prototype.getTable=function(){return this.sj},b.prototype.doFilter=function(b,c,d){var e,f,h,i,j,k,l,m,n,o,p,q,r,s,u,v=this,w=v.kj,x=v.sj,z=v.xr,A=c.ranges,B=c.exclusiveRowIndexes,C=!!B,D={columnName:b,oldValue:v.getFilteredIndexes(b)},E=v.getColumnIndex(b);if(!(E<0||!C&&!A)){if(d)a.prototype.doFilter.call(this,b,c,d);else{if(e=C?v.getExclusiveData(b):v.getData(b),f=[],C)f=B;else for(h=v.ef(),i=v.ff(),h[E]||v.We(E),j=h[E],k=0;k<t(A);k++)for(l=A[k],m=v.Xe(j,l),n=m.start;n<=m.end;n++)f.push(i[E][n]);if(w.suspendPaint(),o=x.startColumn()+E,z&&z.removeFilterItems(o,!0),w.AR(),g.$V){for(p=[],q=0;q<t(f);q++)r=g.$V(2,0,e[f[q]]),r.useWildCards(!1),p.push(r);z&&z.addFilterItem(o,p)}a.prototype.hf.call(this,b,c),s=[],u={},v.gf(b,s,u),z&&(z.filter(o,!0),z.onFilter(z.SX(0,[o])),w.ITa.gVa(z,7,y,!0)),v.onFiltered(),w.resumePaint()}w.ITa.xVa(v,na,D,{columnName:b,oldValue:v.getFilteredIndexes(b)})}},b.prototype.doUnfilter=function(b){var c,d,e=this,f=e.kj,g=e.sj,h=e.getColumnIndex(b),i=e.xr;h!==-1&&(c={columnName:b,oldValue:e.getFilteredIndexes(b)},d=g.startColumn()+h,i.removeFilterItems(d),a.prototype.if.call(this,b),i.unfilter(d,!0),i.onFilter(i.SX(0,[d])),e.onFiltered(),e.kj.$p(),f.ITa.xVa(e,na,c,{columnName:b,oldValue:e.getFilteredIndexes(b)}))},b.prototype.refresh=function(){var a=this,b=[],c=[];Ec(a.sj,b,c),a.bf(b,c)},b.prototype.onColumnNameChanged=function(b,c){var d,e,f=this;a.prototype.onColumnNameChanged.call(this,b,c),d=f.kj.parent,e=d&&d.sheets||[f.kj],e.forEach(function(a){a.slicers.all().forEach(function(a){a.ZX===f&&a.columnName()===b&&a.columnName(c)})})},b.prototype.onRowsAdded=function(b,c){var d,e,f=this,g=f.kj,h=f.sj,i=h.dataRange();for(a.prototype.onRowsAdded.call(this,b,c,!0),d=b;d<b+c;d++)for(e=0;e<t(f.columnNames);e++)f.data[d][e]={value:g.getValue(i.row+d,i.col+e),text:g.getText(i.row+d,i.col+e)};f.bf(f.data,f.columnNames),f.cf("onRowsChanged",b,c,!0)},b.prototype.onRowsRemoved=function(b,c){a.prototype.df.call(this,b,c,!1)},b.prototype.onColumnsAdded=function(a,b){var c,d,e,f,g=this,h=g.kj,i=g.sj,j=i.dataRange(),k=g.data,l=g.columnNames;for(c=0;c<t(k);c++)for(d=a;d<a+b;d++)k[c].splice(d,0,{value:h.getValue(j.row+c,j.col+d),text:h.getText(j.row+c,j.col+d)});for(e=a;e<a+b;e++)f=i.getColumnName(e)||"",l.splice(e,0,f);g.bf(k,l)},b.prototype.onColumnsRemoved=function(b,c){var d,e,f=this,g=f.kj,h=f.sj.name(),i=f.columnNames,j=[];for(d=b;d<b+c;d++)i[d]&&j.push(i[d]);a.prototype.onColumnsRemoved.call(this,b,c),e=g&&g.slicers,j.forEach(function(a){e.all(h,a).forEach(function(a){e.remove(a.name())})})},b.prototype.onTableRemoved=function(a){var b,c,d,e=this;a&&a===e.sj&&(e.MX=[],b=e.kj,c=b.slicers,d=a.name(),c.all(d).forEach(function(a){e.MX.push(a),c.remove(a.name())}),c&&Lc(c,e),e.Ze=[])},b.prototype.onTableAdded=function(a){var b,c=this,d=c.kj,e=d.slicers;e&&a&&a.Aq()&&Kc(e,a.getSlicerData()),b=c.MX||[],b.forEach(function(a){var b=a.name(),c=a.ZX.sj.name(),d=a.columnName(),f=a.style();e.add(b,c,d,f)})},b}(G),b.TableSlicerData=ib,h.Table&&d.GC$.extend(h.Table.prototype,{getSlicerData:function(){var a=this;return a.ZX||(a.ZX=new ib(a)),a.ZX}});function Jc(a){var b=a.sj,c,d;return b&&(c=b.kj,d=b.rowFilter()),c&&(!c.options.isProtected||d&&d.TX(c))}jb=function(a){Hb(b,a);function b(b,c,d){var e=a.call(this,b,c,d)||this;return e.isSelected(!1),e}return b.prototype.no=function(){var b=this;b.sj=z,b.slicer(z),b.sheet(z),a.prototype.no.call(this)},b.prototype.IX=function(){var b=this,c=b.slicerData;c&&c instanceof ib&&(b.sheet(c.OW()),b.sj=c.getTable()),a.prototype.IX.call(this)},b.prototype.onColumnRemoved=function(a){var b,c=this,d=c.sheet(),e=c.sj,f=c.slicerData;a===c.columnName&&(b=f.getFilteredOutIndexes(a,1),0!==t(b)&&f.doUnfilter(a),d&&e&&d.wr.Fb(c.name()))},b.prototype.mX=function(a,b){var c,d,f,g,h,i,j=this,k=j.slicerData,l=k.getColumnIndex(j.columnName),m=j.sj,n=m.dataRange(),o=[];if(0===b)return a;for(c=[],d=k.OW(),f=0;f<t(a);f++)g=k.getRowIndexes(j.columnName,f),c.push(d.getValue(n.row+g[0],n.col+l));for(h=e.Slicers.jf.quickSort(c),i=0;i<t(h);i++)o[i]=a[h[i].index];return 2===b&&o.reverse(),o},b.prototype.Bw=function(b,c){var d,e,f=this,g=f.sheet(),h=f.slicer();for(h&&g.ER(h)||(c.newValue=c.oldValue),d=Rc(h),e=0;e<t(d);e++)a.prototype.JX.call(this,b,c)},b.prototype.AD=function(b){var c,d,e,f=this,g=f.sheet(),h=f.slicer();if(h&&g.ER(h)){if(c=yc(f,b),!Jc(f)&&(5===c[Qa]||6===c[Qa]||8===c[Qa]))return void b.stopPropagation();for(d=Rc(h),e=0;e<t(d);e++)a.prototype.AD.call(this,b)}},b.prototype.CD=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p=this,q=p.sheet(),r=p.slicer();if(r&&q.ER(r)&&Jc(p)&&(b=yc(p,a))){for(c=p.slicerData,d=p.vX,e=p.wX,f=c.getExclusiveData(p.columnName),g=!1,h=z,4===b[Qa]||5===b[Qa]&&t(e)===t(f)&&!p.yX&&!p.KX?(i=c.getFilteredIndexes(p.columnName),h=q.wu().execute({cmd:"unfilterSlicer",sheetName:q.name(),slicerData:c,columnName:p.columnName,value:i}),g=!0):d&&t(d)>0&&!p.yX&&!p.KX&&(j=c.getFilteredIndexes(p.columnName),k=e.concat(),h=q.wu().execute({cmd:"filterSlicer",sheetName:q.name(),slicerData:c,columnName:p.columnName,oldValue:j,newValue:k}),g=!0),l=Rc(r),m=0,n=t(l);m<n;m++)o=l[m],o.GX=!1,o.HX=!1,g&&(o.vX=[],o.wX=[]);return!!h}},b.prototype.BD=function(b){var c,d,e=this,f=e.sheet(),g=e.slicer();if(g&&!e.HX&&f.ER(g))for(c=Rc(g),d=0;d<t(c);d++)a.prototype.BD.call(this,b)},b.prototype.uX=function(){var b,c,d=this,e=d.sheet(),f=d.slicer();if(f&&e.ER(f))for(b=Rc(f),c=0;c<t(b);c++)a.prototype.uX.call(this)},b.prototype.Rw=function(b){var c,d,e,f,g=this;return!!a.prototype.Rw.call(this,b)||(!(c=g.sheet())||(d=c.slicers,e=d&&d.UX(),f=g.nX,!!(e&&1===t(e)&&g.isSelected()&&g.iX()&&f)&&(f.sC(b),b.stopPropagation(),!0)))},b.prototype.om=function(a){var b,c,d,e,f=this,g=f.slicerData,h=f.sheet(),i=f.wX;17===a.keyCode&&f.yX&&(f.yX=!1),16===a.keyCode&&f.KX&&(f.KX=!1),!f.yX&&!f.KX&&t(f.vX)>0&&(b=t(g.getExclusiveData(f.columnName)),t(i)===b?(c=g.getFilteredIndexes(f.columnName),h.wu().execute({cmd:"unfilterSlicer",sheetName:h.name(),slicerData:g,columnName:f.columnName,value:c})):(d=g.getFilteredIndexes(f.columnName),e=i.concat(),h.wu().execute({cmd:"filterSlicer",sheetName:h.name(),slicerData:g,columnName:f.columnName,oldValue:d,newValue:e})),f.vX=[],f.wX=[])},b.prototype.toJSON=function(){return{slicerName:this.name(),columnName:this.columnName}},b}(db),jb.prototype.isSelected=s("isSelected",!1),jb.prototype.sheet=s("sheet"),jb.prototype.slicer=s("slicer");function Kc(a,b){var c,d,e=a.VX;if(b){for(c=b.getTable(),d=0;d<t(e);d++)if(e[d].getTable()===c)return;e.push(b)}}function Lc(a,b){q.Fb(a.VX,b)}function Mc(a,b){var c,d,e,f=a.VX;for(c=0;c<t(f);c++)if(d=f[c],e=d.getTable(),d&&e&&e.tableName()===b)return d;return z}kb="nameInFormula",lb="captionName",mb="columnCount",nb="columnName",ob="itemHeight",pb="showHeader",qb="sortState",rb="disableResizingAndMoving",sb="showNoDataItems",tb="showNoDataItemsInLast",ub="visuallyNoDataItems",vb="isSelected",wb="dynamicMove",xb="dynamicSize",yb="tableName",zb="Slicer",Ab=100,Bb=100,Cb=192,Db=250,Eb=[];function Nc(a,b,c){var d,e,f=a.ZX;f&&(d=f.OW(),e=d.slicers,e.all().forEach(function(d){d===a&&(e.U3(b,c),a.onPropertyChanged(L,c,b))}))}for(Fb=function(a){Hb(b,a);function b(b,c,d){var e,f,g,h,i=a.call(this,b,Ab,Bb,Cb,Db)||this;return i.l8=j.SlicerType.table,e=i,e.typeName=zb,e.g3=zb,c&&(f=c.kj,e.sheet(f),c.l$c&&(c.a$(),c.l$c=!1),g=Mc(f.slicers,c.tableName())),g||(g=c.getSlicerData()),e.ZX=g,e[nb](d),e.$X=[],e._X=d,h=zb+"_"+d,e.sheet()&&e.sheet().parent&&(h=e.sheet().parent.j$c(d,e.l8)),e[kb](h),e[lb](d),e[xb](!1),e[wb](!1),i}return b.prototype.no=function(a){if(a!==!1){var b=this;b.$X&&(b.$X.forEach(function(a){a.no()}),b.$X=z),b.ZX&&(b.ZX.no(),b.ZX=z),b.sheet(z)}},b.prototype.sourceName=function(){return this._X},b.prototype.cloneContent=function(){var a=this,b=a.sheet(),c=a.ZX,d=new jb(a.name(),c,a.columnName());return d.width(a.width(),!1),d.height(a.height(),!1),d.captionName(a.captionName()),d.columnCount(a.columnCount()),d.itemHeight(a.itemHeight()),d.showHeader(a.showHeader()),d.sortState(a.sortState()),d.isLocked(a.isLocked()),d.disableResizingAndMoving(a.disableResizingAndMoving()),d.showNoDataItems(a.showNoDataItems()),d.showNoDataItemsInLast(a.showNoDataItemsInLast()),d.visuallyNoDataItems(a.visuallyNoDataItems()),d.style(a.style().toJSONInternal()),d.zoomFactor(b.zoom()),d.isSelected(a.isSelected()),d.slicer(a),d.sheet()!==b&&d.sheet(b),a.$X.push(d),d.getDOMElement()},b.prototype.YX=function(){return this.ZX},b.prototype.hga=function(){return!1},b.prototype.LXc=function(a){for(var b=1,c=this,d=a,e=c.sheet().parent;j.h$c(e,d);)d=a+b,b++;return d},b.prototype.refresh=function(a){var b,c=this.$X;for(b=0;b<t(c);b++)fc(c[b],a)},b.prototype.refreshContent=function(a){var b=this,c=b.sheet().zoom();c!==b.MP&&(b.MP=c,b.refresh(c))},b.prototype.clone=function(a){var c,d=this;return!d.sheet()&&a&&d.sheet(a,!1),c=new b(d.name(),Qc(d),d.columnName()),c.sheet(d.sheet(),!1),c.fromJSON(d.toJSON(),!1,d.ZX),c},b.prototype.fromJSON=function(b,c,e){var f,g,h,i,j,l,m,n,o,p,q;b&&(f=this,g=b.tableName,h=b[nb],g&&h&&(a.prototype.fromJSON.call(this,b),i=f.sheet(),j=i.slicers,l=i.parent,m=e?e:Mc(j,g),m||(n=l.jga(g),m=n.getSlicerData(),Kc(j,m)),f.ZX=m,f[nb](h),o=b.x!==y?b.x:Ab,p=b.y!==y?b.y:Bb,f.position(new d.Point(o,p)),f[S](b[S]!==y?b[S]:Cb,!1),f[T](b[T]!==y?b[T]:Db,!1),b.sourceName!==y&&(f._X=b.sourceName),Eb.forEach(function(a){var c=b[a];c!==y&&f[a](c,!1)}),b.style!==y&&(q=new k.SlicerStyle,q.fromJSON(b.style),f.style(q,!1))))},b.prototype.toJSON=function(a){var b,c,d,e,f,g=this,h={};return h.type=g.l8,b=["x","y",S,T,wb,xb,"isLocked","fixedPosition"],b.forEach(function(a){var b=g[a]();g[a].isDefault(b)&&a!==wb&&a!==xb||(h[a]=b)}),c=g._X,c&&(h.sourceName=c),g[M]()&&(h[M]=g[M]().toJSON()),d=g.ZX,e=d.getTable(),f=p(e.KXc)?e[yb]():e.KXc,p(a)?h[L]=g.name():h[L]=g.LXc(g.name()),e[yb]&&(h[yb]=f),Eb.forEach(function(a){var b=g[a]();a===M||g[a].isDefault(b)||a!==L&&(h[a]=b)}),h},b.prototype.Wq=function(a){var b=this.sheet();b&&b.Wq(d.Events.SlicerChanged,a)},b}(f.FloatingObject),b.TableSlicer=Fb,b.Slicer=Fb,Gb=[["name","",function(a,b,c){Nc(this,c,b)},j.checkSlicerName],[lb,"",Pc],[mb,1,Pc,Ac],[ob,21,Pc,Ac],[pb,!0,Pc],[qb,1,Pc],[rb,!1,function(a,b,c){var d,e=this;e.allowMove(!b,!1),e.allowResize(!b,!1),Pc.call(e,rb,b,c),d=e.sheet(),d&&d.$p()}],[sb,!0,Pc],[tb,!0,Pc],[ub,!0,Pc],[M,k.SlicerStyles.light1(),Pc],[nb,"",function(a,b,c){var d,e=this;e._X=b,e.captionName(b,!1),d=e.sheet(),d.ITa.xVa(e,a,c,b)}]],fb=0,gb=t(Gb);fb<gb;fb++)Fb.prototype[Gb[fb][0]]=Oc(Gb[fb][0],Gb[fb][1],Gb[fb][2],Gb[fb][3]);function Oc(a,b,c,d){return Eb.push(a),s(a,b,function(b,d){c.call(this,a,b,d)},d)}function Pc(a,b,c){var d,e,f=this,g=f.$X||[];for(d=0;d<t(g);d++)g[d][a]&&("style"===a?g[d][a](b.toJSONInternal()):g[d][a](b));e=f.sheet(),e&&(e.ITa.xVa(f,a,c,b),f.Wq({sheet:e,sheetName:e.name(),slicer:f,propertyName:a}))}function Qc(a){return a.ZX.getTable()}function Rc(a){return a.$X}Fb.prototype.nameInFormula=Oc(kb,"",Pc,function(a){var b=this,c=b.sheet()&&b.sheet().parent;return!c||!c.k$c(a,b.l8)}),Fb.prototype.onPropertyChanged=Pc,d.Worksheet.$n("TableSlicer",{slicerAdding:function(a){var b,c,d,e,f,g=this;if(a.type===j.SlicerType.table)return b=a.slicerName,c=a.targetName,d=a.itemName,e=g.getParent(),f=e.jga(c),f&&f.getColumnIndexInTable(d)!==-1?void(a.slicer=new Fb(b,f,d)):z},slicerAdded:function(a){var b=this,c=a.slicer;c instanceof Fb&&(Kc(b.slicers,c.YX()),this.wr.Sb(c))},slicerRemoved:function(a){var b,c,d,e=this,f=a.slicer;if(f instanceof Fb){for(b=f.YX(),c=Rc(f),d=0;d<t(c);d++)b.detachListener(c[d]);e.wr.Fb(f.name()),e.ITa.xVa(e.slicers,"undoRemove",f)}},getAllSlicers:function(a){var b=this,c=a.slicers,e=a.targetName,f=a.itemName;d.GC$.each(b.slicers.WX,function(a,b){b instanceof Fb&&(e&&(Qc(b).name()!==e||f&&b.columnName()!==f)||c.push(b))})},slicerRenamed:function(a){var b=this,c=a.slicer,d=a.oldName,e=a.newName;c instanceof Fb&&b.wr.U3(d,e)},slicerFromJson:function(a){var b,c,d,e,f,g=a.slicerJSON;g.type!==j.SlicerType.table&&g.type||(b=g.tableName,c=g.columnName,d=this.getParent(),b&&c&&(e=d.jga(b),e&&e.getColumnIndexInTable(c)!==-1&&(f=new Fb(g.name,e,c),f.sheet(this),f.fromJSON(g),this.slicers.Cz(f),this.wr.Sb(f))))}}),w(d.Worksheet.prototype,{t4:function(a,b,c,d,e){var f,g,h,i,j,k,l,m,n;if(e===y&&(e=3),f=this,g=f.tables){for(h=0;h<c;h++)for(i=0;i<d;i++)j=h+a,k=i+b,l=g.find(j,k),3===e&&l&&l.Aq()&&(m=l.dataRange(),m.contains(j,k)&&(n=l.getSlicerData(),n&&n.onDataChanged([{columnName:l.getColumnName(k-m.col),row:j-m.row,data:{value:f.getValue(j,k),text:f.getText(j,k)}}])));f.ITa.xVa(null,oa,{row:a,col:b,rowCount:c,colCount:d,sheetArea:e})}}})},Common:function(a,b){a.exports=GC.Spread},ConditionalFormatting:function(a,b){a.exports=GC.Spread.Sheets.ConditionalFormatting},Core:function(a,b){a.exports=GC.Spread.Sheets},FloatingObject:function(a,b){a.exports=GC.Spread.Sheets.FloatingObjects},Tables:function(a,b){a.exports=GC.Spread.Sheets.Tables}});